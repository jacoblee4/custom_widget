findHierarchicalApprover: function(startingApproverSysId, divisionHeadSysId, amount, type) {
        var result = {
            found_approver: false,
            approver_sys_id: '',
            is_division_head: false,
            reached_division_head: false,
            reached_ceo: false,
            message: ''
        };

		gs.info("SIGNATURE LOG | startingApproverSysId: " + startingApproverSysId);
		gs.info("SIGNATURE LOG | divisionHeadSysId: " + divisionHeadSysId);
		gs.info("SIGNATURE LOG | amount: " + amount);
		gs.info("SIGNATURE LOG | type: " + type);

        var currentApprover = startingApproverSysId;
        var maxLevels = 20;
        var currentLevel = 0;

        while (currentApprover && currentLevel < maxLevels) {
            // Check if approver exists and is active
            var userGr = new GlideRecord('sys_user');
            if (!userGr.get(currentApprover)) {
                result.message = 'User not found in hierarchy';
                break;
            }

            if (userGr.getValue('active') !== 'true') {
                result.message = 'Inactive user found in hierarchy: ' + userGr.getValue('name');
                break;
            }

            // Check if this is the CEO
            if (this._isCEO_check(currentApprover)) {
                result.reached_ceo = true;
                result.message = 'CEO found in hierarchy - escalating to committee';
                return result;
            }

            // Check if this person has authority
            var authCheck = this.checkDelegatedAuthority(currentApprover, amount, type);
            if (authCheck.has_authority) {
                result.found_approver = true;
                result.approver_sys_id = currentApprover;
                result.message = authCheck.message;
                return result;
            }

            // Check if this is the division head
            if (currentApprover === divisionHeadSysId) {
                result.reached_division_head = true;
                result.is_division_head = true;
                result.message = 'Reached division head without finding approver with authority';
                return result;
            }

            // Move to next manager - no need to redeclare userGr
            currentApprover = userGr.getValue('manager');
            currentLevel++;
        }

        result.message = 'No approver found in hierarchy';
        return result;
    },
