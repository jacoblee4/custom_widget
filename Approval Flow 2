 // Find the Business Line Approver by traversing up the management chain
    findBusinessLineApprover: function(requestedForSysId) {
        var result = {
            found: false,
            approver_sys_id: '',
            is_ceo: false,
            error_message: ''
        };

        if (!requestedForSysId) {
            result.error_message = 'No requested for user provided';
            return result;
        }

        var currentUser = new GlideRecord('sys_user');
        if (!currentUser.get(requestedForSysId)) {
            result.error_message = 'Requested for user not found';
            return result;
        }

        var maxLevels = 20; // Prevent infinite loops
        var currentLevel = 0;

        while (currentUser && currentLevel < maxLevels) {
            // Check if current user is CEO
            if (this._isCEO(currentUser)) {
                result.is_ceo = true;
                result.found = true;
                result.approver_sys_id = currentUser.getValue('sys_id');
                result.error_message = '';
                return result;
            }

            // Check if current user has the required title
            var currentOfficerTitle = currentUser.getValue('u_officer_title') || '';

            if (this.businessLineTitles.indexOf(currentOfficerTitle) > -1) {
                result.found = true;
                result.approver_sys_id = currentUser.getValue('sys_id');
                return result;
            }

            // Move up to manager
            var managerSysId = currentUser.getValue('manager');
            if (!managerSysId) {
                result.error_message = 'No Business Line Approver found - reached top of hierarchy';
                break;
            }

            if (!currentUser.get(managerSysId)) {
                result.error_message = 'Manager record not found in chain';
                break;
            }

            currentLevel++;
        }

        if (currentLevel >= maxLevels) {
            result.error_message = 'Maximum hierarchy levels reached without finding approver';
        }

        return result;
    },
